@model FreelancerProject.ViewModels.FreelancerCompetenceViewModel
@{
    ViewBag.Title = "Index";
}

<h2>
    Index
</h2>

<div>
    <div class="form-group">
        @Html.DropDownListFor(model => model.RoleId, ViewBag.Roles as SelectList, "Välj", new { @class = "form-control" })
    </div>
    <div class="form-group">
        @Html.DropDownListFor(model => model.CompetenceId, new SelectList(" "), "Välj", new { @class = "form-control" })
    </div>
</div>

<script src="~/Scripts/jquery-3.3.1.min.js"></script>

@* Källa: https://www.youtube.com/watch?v=XVbRcLAmK4U & https://www.c-sharpcorner.com/UploadFile/4d9083/creating-simple-cascading-dropdownlist-in-mvc-4-using-razor/ *@
<script>
    $(document).ready(function () {
        $("#RoleId").change(function () {
            $.get("/Freelancer_Competence/GetCompetenceList", { RoleId: $("#RoleId").val() }, function (competence) {
                $("#CompetenceId").empty();
                $.each(competence, function (index, row) {
                    $("#CompetenceId").append("<option value='" + row.CompetenceId + "'>" + row.CompetenceName + "</option>");
                });
            });
        })
    });
</script>